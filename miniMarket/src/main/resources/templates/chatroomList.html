<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<link href="css/bootstrap.css" rel="stylesheet" type="text/css" media="all" />
<link href="css/style.css" rel="stylesheet" type="text/css" media="all" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<script type="text/javascript">
	$(document).ready(function(){
		
	});
</script>
<style>
	#href {
	pointer-events: none;
	cursor: default;
	color: black;
	}
</style>
</head>
<body style="">
	<h1>채팅방 리스트</h1>
	<form method="post" th:action="@{chatRoomList} " id="chatroomListForm">
		<table border="1">
			<tr>
				<td>방번호</td>
				<td>게시글 이름</td>
				<td>상대방 닉네임</td>
				<td>활성화 여부</td>
				<td>채팅방 상태</td>
				<td>판매 / 구매</td>
				<td>채팅내역</td>
			</tr>
			<tr th:each="list : ${list}">
				<td th:text="${list.chatroomNo}"></td>
				<td th:text="${list.memberItemTitle}"></td>
				<td th:if="${list.chatroomActive} == connect" >
				<a th:href="@{chatroom(chatroomNo = ${list.chatroomNo})}" th:text="${list.memberId == memberId} ? ${list.nickname} : ${list.memberNickname}" target="_blank" onclick="window.open(this.href,'_blank','width=550,height=800,left=400px,top=100px, scrollbars=yes');return false;"></a>
				</td>
				<td th:unless="${list.chatroomActive} == connect">
				<a href="#" id="href" th:text="${list.memberId == memberId} ? ${list.nickname} : ${list.memberNickname}" target="_blank" onclick="window.open(this.href,'_blank','width=550,height=800,left=400px,top=100px, scrollbars=yes');return false;"></a>
				</td>
				
				
				<!-- 연결 상태별 -->
				<td th:if="${list.chatroomActive} == connect">채팅 활성</td>
				<td th:if="${list.chatroomActive} != connect">채팅 비활성</td>
				
				<td th:if="${list.memberUniqueNo == memberUniqueNo} AND ${list.chatroomActive} == connect AND ${list.memberItemState} == 판매중"><button type="button" disabled="disabled">판매중</button></td>
	            <td th:if="${list.memberUniqueNo == memberUniqueNo} AND ${list.chatroomActive} == connect AND ${list.memberItemState} == 판매완료"><button type="button" disabled="disabled">판매완료</button></td>
	            <td th:if="${list.memberUniqueNo == memberUniqueNo} AND ${list.chatroomActive} == connect AND ${list.memberItemState} == 상품삭제"><button type="button" disabled="disabled">상품삭제</button></td>
	            <td th:if="${list.memberUniqueNo == memberUniqueNo} AND ${list.chatroomActive} != connect AND ${list.memberItemState} == 판매중"><button type="button" disabled="disabled">판매중</button></td>   
	            <td th:if="${list.memberUniqueNo == memberUniqueNo} AND ${list.chatroomActive} != connect AND ${list.memberItemState} == 판매완료"><button type="button" disabled="disabled">요청대기</button></td>   
	            <td th:if="${list.memberUniqueNo == memberUniqueNo} AND ${list.chatroomActive} != connect AND ${list.memberItemState} == 상품삭제"><button type="button" disabled="disabled">상품삭제</button></td>   
	            <td th:if="${list.memberUniqueNo != memberUniqueNo} AND ${list.chatroomActive} == connect AND ${list.memberItemState} == 판매중"><button type="button" disabled="disabled">판매중</button></td>   
	            <td th:if="${list.memberUniqueNo != memberUniqueNo} AND ${list.chatroomActive} == connect AND ${list.memberItemState} == 판매완료"><button type="button" disabled="disabled">판매완료</button></td>   
	            <td th:if="${list.memberUniqueNo != memberUniqueNo} AND ${list.chatroomActive} == connect AND ${list.memberItemState} == 상품삭제"><button type="button" disabled="disabled">상품삭제</button></td>   
	            <td th:if="${list.memberUniqueNo != memberUniqueNo} AND ${list.chatroomActive} != connect AND ${list.memberItemState} == 판매중"><a th:href="@{modifyChatroomActive(chatroomNo = ${list.chatroomNo})}" class="btn">채팅연결</a></td>   
	            <td th:if="${list.memberUniqueNo != memberUniqueNo} AND ${list.chatroomActive} != connect AND ${list.memberItemState} == 판매완료"><button type="button" disabled="disabled">판매완료</button></td>   
	            <td th:if="${list.memberUniqueNo != memberUniqueNo} AND ${list.chatroomActive} != connect AND ${list.memberItemState} == 상품삭제"><button type="button" disabled="disabled">상품삭제</button></td>
					
				
				<td th:if="${list.memberUniqueNo == memberUniqueNo}">구매</td>
				<td th:if="${list.memberUniqueNo != memberUniqueNo}">판매</td>
				
				<td th:if="${list.chatroomActive} == disconnect"><a th:href="@{chatList(chatroomNo = ${list.chatroomNo})}" target="_blank" onclick="window.open(this.href,'_blank','width=550,height=800,left=400px,top=100px, scrollbars=yes');return false;">내역보기</a></td>
				<td th:unless="${list.chatroomActive} == disconnect">내역보기</td>
			
			</tr>
		</table>
	</form>
</body>
</html>